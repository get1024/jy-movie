{"remainingRequest":"E:\\project\\jy-movie\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\project\\jy-movie\\vue-admin\\src\\views\\film\\Poster.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\project\\jy-movie\\vue-admin\\src\\views\\film\\Poster.vue","mtime":1711436195521},{"path":"E:\\project\\jy-movie\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711422139374},{"path":"E:\\project\\jy-movie\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1711422143977}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgY29uZmlnIGZyb20gIkAvY29uZmlnIjsNCmltcG9ydCB7IEFkZFBvc3RlciwgRGVsZXRlQWxsUG9zdGVyLCBEZWxldGVQb3N0ZXJCeUlkLCBMaXN0QWxsUG9zdGVyLCBVcGRhdGVQb3N0ZXIgfSBmcm9tICJAL2FwaS9maWxtIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KDQogIG1vdW50ZWQoKSB7DQogICAgTGlzdEFsbFBvc3RlcigpLnRoZW4ocmVzID0+IHsNCiAgICAgIHRoaXMucG9zdGVyTGlzdCA9IHJlcy5kYXRhDQogICAgfSkNCiAgfSwNCg0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBoZWFkZXI6IHsNCiAgICAgICAgIkF1dGhvcml6YXRpb24iOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKQ0KICAgICAgfSwNCiAgICAgIGRpYWxvZ0Zvcm1WaXNpYmxlOiBmYWxzZSwNCiAgICAgIHVwbG9hZEFjdGlvbjogY29uZmlnLkFQSV9VUkwgKyAnL3VwbG9hZCcsDQogICAgICB1cGxvYWRQb3N0ZXI6IHsNCiAgICAgICAgdXJsOiAnJywNCiAgICAgICAgdGl0bGU6ICcnLA0KICAgICAgICBzdGF0dXM6ICcnLA0KICAgICAgICBjcmVhdGVBdDogJycsDQogICAgICB9LA0KICAgICAgcG9zdGVyTGlzdDogW10sDQogICAgfQ0KICB9LA0KDQogIG1ldGhvZHM6IHsNCg0KICAgIGhhbmRsZVVwbG9hZFN1Y2Nlc3MocmVzKSB7DQogICAgICB0aGlzLnVwbG9hZFBvc3Rlci51cmwgPSByZXMNCiAgICB9LA0KDQogICAgc3VibWl0VXBsb2FkKCkgew0KICAgICAgQWRkUG9zdGVyKHRoaXMudXBsb2FkUG9zdGVyKS50aGVuKHJlcyA9PiB7DQogICAgICAgIGNvbnNvbGUubG9nKHJlcykNCiAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlOw0KICAgICAgfSkNCiAgICB9LA0KDQogICAgZGVsZXRlQWxsUG9zdGVyKCkgew0KICAgICAgRGVsZXRlQWxsUG9zdGVyKCkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLnBvc3Rlckxpc3QgPSBudWxsOw0KICAgICAgfSkNCiAgICB9LA0KDQogICAgY2hhbmdlUG9zdGVyU3RhdHVzKGluZGV4LCBwb3N0ZXIsIHN0YXR1cykgew0KICAgICAgcG9zdGVyLnN0YXR1cyA9IHN0YXR1cw0KICAgICAgVXBkYXRlUG9zdGVyKHBvc3RlcikudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLnBvc3Rlckxpc3RbaW5kZXhdLnN0YXR1cyA9IHN0YXR1cw0KICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICBtZXNzYWdlOiAn5oiQ5Yqf5raI5oGv77ya5pON5L2c5oiQ5YqfJywNCiAgICAgICAgICB0eXBlOiAnc3VjY2VzcycNCiAgICAgICAgfSk7DQogICAgICB9KQ0KICAgIH0sDQoNCiAgICBoYW5kbGVEZWxldGVQb3N0ZXIoaW5kZXgsIGlkKSB7DQogICAgICBEZWxldGVQb3N0ZXJCeUlkKGlkKS50aGVuKHJlcyA9PiB7DQogICAgICAgIHRoaXMucG9zdGVyTGlzdC5zcGxpY2UoaW5kZXgsIDEpOw0KICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICBtZXNzYWdlOiAn5oiQ5Yqf5raI5oGv77ya5Yig6Zmk5oiQ5YqfJywNCiAgICAgICAgICB0eXBlOiAnc3VjY2VzcycNCiAgICAgICAgfSk7DQogICAgICB9KQ0KICAgIH0sDQoNCiAgfQ0KfQ0K"},{"version":3,"sources":["Poster.vue"],"names":[],"mappings":";AA4EA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Poster.vue","sourceRoot":"src/views/film","sourcesContent":["<template>\r\n  <div>\r\n    <el-carousel v-if=\"posterList.length !== 0\" height=\"500px\" indicator-position=\"outside\">\r\n      <el-carousel-item v-for=\"(item, index) in posterList\" :key=\"index\">\r\n        <img alt=\"\" :src=\"item.url\" class=\"image\" style=\"border-radius: 50px;width: 90%;margin-left: 5%\">\r\n      </el-carousel-item>\r\n    </el-carousel>\r\n\r\n    <div class=\"content\">\r\n      <el-button @click=\"dialogFormVisible = true\" type=\"primary\" icon=\"el-icon-upload\">\r\n        上传轮播海报\r\n      </el-button>\r\n      <el-button style=\"margin-left: 10px\" type=\"danger\" icon=\"el-icon-delete\" @click=\"deleteAllPoster\">\r\n        删除所有海报\r\n      </el-button>\r\n      <el-table ref=\"filterTable\" :data=\"posterList\" style=\"width: 100%;margin-top: 15px;\">\r\n        <el-table-column prop=\"createAt\" label=\"上传时间\" width=\"220\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"title\" label=\"标题\" width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column label=\"地址预览\">\r\n          <template slot-scope=\"scope\">\r\n            <a target=\"_blank\" :href=\"scope.row.url\">{{ scope.row.url }}</a>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"status\" label=\"上架状态\" width=\"220\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tag v-if=\"scope.row.status\" type=\"success\" disable-transitions>上架\r\n            </el-tag>\r\n            <el-tag v-else type=\"warning\" disable-transitions>下架\r\n            </el-tag>\r\n            <el-button v-if=\"!scope.row.status\" style=\"padding: 0 15px;color: #67C23A\" type=\"text\"\r\n              @click=\"changePosterStatus(scope.$index, scope.row, true)\" icon=\"el-icon-upload2\">上架\r\n            </el-button>\r\n            <el-button v-else style=\"padding: 0 15px;color: #E6A23C\" type=\"text\"\r\n              @click=\"changePosterStatus(scope.$index, scope.row, false)\" icon=\"el-icon-download\">下架\r\n            </el-button>\r\n            <template style=\"padding-left: 100px\">\r\n              <el-popconfirm @confirm=\"handleDeletePoster(scope.$index, scope.row.id)\" title=\"确定要删除这条内容吗？\">\r\n                <el-button slot=\"reference\" style=\"color: #F56C6C\" type=\"text\" icon=\"el-icon-delete\">删除\r\n                </el-button>\r\n              </el-popconfirm>\r\n            </template>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n\r\n    <el-dialog title=\"轮播海报\" :visible.sync=\"dialogFormVisible\">\r\n      <el-form :model=\"uploadPoster\">\r\n        <el-form-item label=\"海报标题\" style=\"margin-bottom: 35px\" label-width=\"120px\">\r\n          <el-input style=\"width: 360px\" v-model=\"uploadPoster.title\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"上架状态\" style=\"margin-bottom: 35px\" label-width=\"120px\">\r\n          <el-select style=\"width: 360px\" v-model=\"uploadPoster.status\" placeholder=\"请选择活动区域\">\r\n            <el-option label=\"上架\" value=\"true\"></el-option>\r\n            <el-option label=\"下架\" value=\"false\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"选择图片\" label-width=\"120px\">\r\n          <el-upload style=\"float: left\" class=\"upload-demo\" accept=\".png,.jpg\" :headers=\"header\" :action=\"uploadAction\"\r\n            :on-success=\"handleUploadSuccess\" multiple :limit=\"1\">\r\n            <el-button type=\"primary\" icon=\"el-icon-upload\">上传轮播海报</el-button>\r\n          </el-upload>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitUpload\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport config from \"@/config\";\r\nimport { AddPoster, DeleteAllPoster, DeletePosterById, ListAllPoster, UpdatePoster } from \"@/api/film\";\r\n\r\nexport default {\r\n\r\n  mounted() {\r\n    ListAllPoster().then(res => {\r\n      this.posterList = res.data\r\n    })\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      header: {\r\n        \"Authorization\": localStorage.getItem(\"token\")\r\n      },\r\n      dialogFormVisible: false,\r\n      uploadAction: config.API_URL + '/upload',\r\n      uploadPoster: {\r\n        url: '',\r\n        title: '',\r\n        status: '',\r\n        createAt: '',\r\n      },\r\n      posterList: [],\r\n    }\r\n  },\r\n\r\n  methods: {\r\n\r\n    handleUploadSuccess(res) {\r\n      this.uploadPoster.url = res\r\n    },\r\n\r\n    submitUpload() {\r\n      AddPoster(this.uploadPoster).then(res => {\r\n        console.log(res)\r\n        this.dialogFormVisible = false;\r\n      })\r\n    },\r\n\r\n    deleteAllPoster() {\r\n      DeleteAllPoster().then(res => {\r\n        this.posterList = null;\r\n      })\r\n    },\r\n\r\n    changePosterStatus(index, poster, status) {\r\n      poster.status = status\r\n      UpdatePoster(poster).then(res => {\r\n        this.posterList[index].status = status\r\n        this.$message({\r\n          message: '成功消息：操作成功',\r\n          type: 'success'\r\n        });\r\n      })\r\n    },\r\n\r\n    handleDeletePoster(index, id) {\r\n      DeletePosterById(id).then(res => {\r\n        this.posterList.splice(index, 1);\r\n        this.$message({\r\n          message: '成功消息：删除成功',\r\n          type: 'success'\r\n        });\r\n      })\r\n    },\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.content {\r\n  padding: 20px 40px;\r\n}\r\n\r\n.el-carousel__item h3 {\r\n  color: #475669;\r\n  font-size: 18px;\r\n  opacity: 0.75;\r\n  line-height: 300px;\r\n  margin: 0;\r\n}\r\n\r\n.image {\r\n  width: 100%;\r\n  height: 500px;\r\n}\r\n</style>"]}]}