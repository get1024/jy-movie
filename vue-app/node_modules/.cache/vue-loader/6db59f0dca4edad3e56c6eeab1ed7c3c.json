{"remainingRequest":"E:\\project\\jy-movie-project\\jy-movie\\vue-app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\project\\jy-movie-project\\jy-movie\\vue-app\\src\\views\\Seat.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\project\\jy-movie-project\\jy-movie\\vue-app\\src\\views\\Seat.vue","mtime":1711526625163},{"path":"E:\\project\\jy-movie-project\\jy-movie\\vue-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711422138956},{"path":"E:\\project\\jy-movie-project\\jy-movie\\vue-app\\node_modules\\vue-loader\\lib\\index.js","mtime":1711422143549}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBGaW5kQXJyYW5nZW1lbnRCeUlkLCBHZXRBcnJhbmdlbWVudFNlYXRzIH0gZnJvbSAiQC9hcGkvZmlsbSI7DQppbXBvcnQgeyBDcmVhdGVDYXJ0IH0gZnJvbSAiQC9hcGkvY2FydCI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgY2FydDogew0KICAgICAgICB1aWQ6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1aWQiKSwNCiAgICAgICAgYWlkOiB0aGlzLiRyb3V0ZS5xdWVyeS5pZCwNCiAgICAgICAgc2VhdHM6ICcnLA0KICAgICAgICBwaG9uZTogIjE4OTAzODAzNjU4IiwNCiAgICAgICAgcHJpY2U6IDANCiAgICAgIH0sDQogICAgICBhcnJhbmdlbWVudDoge30sDQogICAgICBmaWxtOiB7fSwNCiAgICAgIHNlYXRzOiBbXSwNCiAgICAgIHVzZXJTZWxlY3RTZWF0czogW10sDQogICAgICBzZWxlY3RTZWF0czogW10sDQogICAgfQ0KICB9LA0KDQogIG1vdW50ZWQoKSB7DQogICAgRmluZEFycmFuZ2VtZW50QnlJZCh0aGlzLiRyb3V0ZS5xdWVyeS5pZCkudGhlbigocmVzKSA9PiB7DQogICAgICB0aGlzLmFycmFuZ2VtZW50ID0gcmVzLmRhdGEuYXJyYW5nZW1lbnQ7DQogICAgICB0aGlzLmZpbG0gPSByZXMuZGF0YS5maWxtOw0KICAgICAgR2V0QXJyYW5nZW1lbnRTZWF0cyh0aGlzLiRyb3V0ZS5xdWVyeS5pZCkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLnNlbGVjdFNlYXRzID0gcmVzLmRhdGE7DQogICAgICAgIHRoaXMubG9hZFNlYXRzKCk7DQogICAgICB9KQ0KICAgIH0pOw0KICB9LA0KDQogIG1ldGhvZHM6IHsNCiAgICAvLzAg5bey6YCJDQogICAgLy8xIOWPr+mAiQ0KICAgIC8vMiDlt7LpgInkuK0NCiAgICBsb2FkU2VhdHMoKSB7DQogICAgICBjb25zdCBuID0gdGhpcy5hcnJhbmdlbWVudC5zZWF0TnVtYmVyDQogICAgICBsZXQgYXJyID0gbmV3IEFycmF5KG4pDQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykgew0KICAgICAgICBpZiAodGhpcy5zZWxlY3RTZWF0cy5pbmRleE9mKGkgKyAxKSA9PT0gLTEpIHsNCiAgICAgICAgICBhcnJbaV0gPSB7IHNlYXQ6IGkgKyAxLCBzdGF0dXM6IDEgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGFycltpXSA9IHsgc2VhdDogaSArIDEsIHN0YXR1czogMCB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHRoaXMuc2VhdHMgPSBhcnINCiAgICB9LA0KDQogICAgaGFuZGxlU2VsZWN0KGluZGV4KSB7DQogICAgICBpZiAodGhpcy51c2VyU2VsZWN0U2VhdHMubGVuZ3RoID49IDQpIHsNCiAgICAgICAgbGV0IGQgPSB0aGlzLnVzZXJTZWxlY3RTZWF0c1swXSAtIDENCiAgICAgICAgdGhpcy5zZWF0c1tkXS5zdGF0dXMgPSAxDQogICAgICAgIHRoaXMudXNlclNlbGVjdFNlYXRzLnNwbGljZSgwLCAxKQ0KICAgICAgfQ0KICAgICAgdGhpcy51c2VyU2VsZWN0U2VhdHMucHVzaChpbmRleCArIDEpDQogICAgICB0aGlzLnNlYXRzW2luZGV4XS5zdGF0dXMgPSAyDQogICAgICB0aGlzLmNhcnQucHJpY2UgPSAodGhpcy5hcnJhbmdlbWVudC5wcmljZSkgKiAodGhpcy51c2VyU2VsZWN0U2VhdHMubGVuZ3RoKQ0KICAgIH0sDQoNCiAgICBoYW5kbGVEaXNTZWxlY3QoaW5kZXgpIHsNCiAgICAgIHRoaXMuc2VhdHNbaW5kZXhdLnN0YXR1cyA9IDENCiAgICAgIHRoaXMudXNlclNlbGVjdFNlYXRzLnNwbGljZSh0aGlzLnVzZXJTZWxlY3RTZWF0cy5pbmRleE9mKGluZGV4ICsgMSksIDEpDQogICAgICB0aGlzLmNhcnQucHJpY2UgPSAodGhpcy5hcnJhbmdlbWVudC5wcmljZSkgKiAodGhpcy51c2VyU2VsZWN0U2VhdHMubGVuZ3RoKQ0KICAgIH0sDQoNCiAgICBjaGVja1Bob25lQW5kU2VhdHMoKSB7DQogICAgICBpZiAodGhpcy51c2VyU2VsZWN0U2VhdHMubGVuZ3RoID09PSAwKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgIG1lc3NhZ2U6ICfor7fpgInmi6nopoHorqLotK3nmoTluqfkvY0nLA0KICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgfQ0KICAgICAgaWYgKHRoaXMuY2FydC5waG9uZS5sZW5ndGggIT09IDExKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaUxMeS9jeeahOeUteivneWPt+eggScsDQogICAgICAgICAgdHlwZTogJ3dhcm5pbmcnDQogICAgICAgIH0pOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9DQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9LA0KDQogICAgc3VibWl0U2VhdCgpIHsNCiAgICAgIGlmICh0aGlzLmNoZWNrUGhvbmVBbmRTZWF0cygpKSB7DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy51c2VyU2VsZWN0U2VhdHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICB0aGlzLmNhcnQuc2VhdHMgKz0gdGhpcy51c2VyU2VsZWN0U2VhdHNbaV0gKyAn5Y+3Jw0KICAgICAgICB9DQogICAgICAgIGNvbnNvbGUubG9nKHRoaXMuY2FydCkNCiAgICAgICAgQ3JlYXRlQ2FydCh0aGlzLmNhcnQpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgIG1lc3NhZ2U6ICfku6XkuLrmgqjmt7vliqDotK3nianovabmiJDlip/vvIzor7flsL3lv6vku5jmrL7lkKcnLA0KICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnDQogICAgICAgICAgfSk7DQogICAgICAgICAgdGhpcy4kcm91dGVyLmdvKC0xKQ0KICAgICAgICB9KQ0KDQogICAgICB9DQogICAgfSwNCg0KICB9LA0KfTsNCg=="},{"version":3,"sources":["Seat.vue"],"names":[],"mappings":";AAsGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA","file":"Seat.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"seat-main\">\r\n    <el-steps style=\"padding-bottom: 50px\" :active=\"2\" align-center>\r\n      <el-step title=\"步骤1\" description=\"选择电影场次\"></el-step>\r\n      <el-step title=\"步骤2\" description=\"选择座位号\"></el-step>\r\n      <el-step title=\"步骤3\" description=\"加入购物车\"></el-step>\r\n      <el-step title=\"步骤4\" description=\"结算付款\"></el-step>\r\n    </el-steps>\r\n    <div class=\"seat-content\">\r\n      <div class=\"seat-aside\">\r\n        <div style=\"display: flex\">\r\n          <img style=\"padding: 30px\" :src=\"film.cover\" alt=\"\" />\r\n          <div>\r\n            <div style=\"\r\n                padding-top: 40px;\r\n                padding-bottom: 10px;\r\n                font-size: 25px;\r\n                letter-spacing: 2px;\r\n              \">\r\n              {{ film.name }}\r\n            </div>\r\n            <div class=\"seat-aside-text\">类型：{{ film.type }}</div>\r\n            <div class=\"seat-aside-text\">地区：{{ film.region }}</div>\r\n            <div class=\"seat-aside-text\">时长：{{ film.duration }}分钟</div>\r\n          </div>\r\n        </div>\r\n        <div style=\"padding: 5px 30px\">\r\n          <div class=\"d1\"><span>放映：</span>{{ arrangement.type }}</div>\r\n          <div class=\"d1\" style=\"color: #f56c6c\">\r\n            <span>开场：</span>{{ arrangement.date }}\r\n            {{ arrangement.startTime }}\r\n          </div>\r\n          <div class=\"d1\"><span>散场：</span>{{ arrangement.endTime }}</div>\r\n          <div class=\"d1\"><span>票价：</span>¥{{ arrangement.price }}/张</div>\r\n          <el-divider></el-divider>\r\n          <div class=\"d1\">\r\n            已选座位：\r\n            <el-tag v-for=\"(item, i) in userSelectSeats\" :key=\"i\" type=\"danger\" style=\"margin-right: 5px\"\r\n              effect=\"light\">\r\n              {{ item }} 号\r\n            </el-tag>\r\n          </div>\r\n          <div class=\"d1\" style=\"padding-top: 10px\">\r\n            总计：\r\n            <span style=\"color: #f56c6c\">¥ </span>\r\n            <span style=\"color: #f56c6c; font-size: 25px; font-weight: bold\">{{ cart.price }}</span>\r\n          </div>\r\n          <el-divider></el-divider>\r\n          <div style=\"padding: 0 50px\">\r\n            <el-input v-model=\"cart.phone\" style=\"padding-top: 20px; padding-bottom: 30px\" placeholder=\"请输入手机号码\"\r\n              clearable>\r\n            </el-input>\r\n            <el-button @click=\"submitSeat\" class=\"add-cart-btn\" type=\"danger\" round>加入购物车\r\n            </el-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"hall seat-select\">\r\n        <div class=\"seat-example\">\r\n          <div class=\"selectable-example example\">\r\n            <span>可选座位</span>\r\n          </div>\r\n          <!-- <div class=\"couple-example example\">\r\n            <span>情侣卡座</span>\r\n          </div> -->\r\n          <div class=\"sold-example example\">\r\n            <span>已售座位</span>\r\n          </div>\r\n          <div class=\"selected-example example\">\r\n            <span>已选座位</span>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <div class=\"seats-block\">\r\n          <div class=\"seats-container\">\r\n            <div class=\"screen-container\" style=\"left: 5px\">\r\n              <div class=\"screen\">银幕中央</div>\r\n              <div class=\"c-screen-line\"></div>\r\n            </div>\r\n\r\n            <div class=\"seats-wrapper\">\r\n              <div style=\"padding: 0 40px;width: 500px\">\r\n                <span v-for=\"(item, index) in seats\" :key=\"index\">\r\n                  <!--不可选-->\r\n                  <span v-if=\"item.status === 0\" class=\"seat sold item\" />\r\n                  <!--可选-->\r\n                  <span v-if=\"item.status === 1\" @click=\"handleSelect(index)\" class=\"seat selectable item\" />\r\n                  <!--已选-->\r\n                  <span v-if=\"item.status === 2\" @click=\"handleDisSelect(index)\" class=\"seat selected item\" />\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { FindArrangementById, GetArrangementSeats } from \"@/api/film\";\r\nimport { CreateCart } from \"@/api/cart\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      cart: {\r\n        uid: localStorage.getItem(\"uid\"),\r\n        aid: this.$route.query.id,\r\n        seats: '',\r\n        phone: \"18903803658\",\r\n        price: 0\r\n      },\r\n      arrangement: {},\r\n      film: {},\r\n      seats: [],\r\n      userSelectSeats: [],\r\n      selectSeats: [],\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    FindArrangementById(this.$route.query.id).then((res) => {\r\n      this.arrangement = res.data.arrangement;\r\n      this.film = res.data.film;\r\n      GetArrangementSeats(this.$route.query.id).then(res => {\r\n        this.selectSeats = res.data;\r\n        this.loadSeats();\r\n      })\r\n    });\r\n  },\r\n\r\n  methods: {\r\n    //0 已选\r\n    //1 可选\r\n    //2 已选中\r\n    loadSeats() {\r\n      const n = this.arrangement.seatNumber\r\n      let arr = new Array(n)\r\n      for (let i = 0; i < n; i++) {\r\n        if (this.selectSeats.indexOf(i + 1) === -1) {\r\n          arr[i] = { seat: i + 1, status: 1 }\r\n        } else {\r\n          arr[i] = { seat: i + 1, status: 0 }\r\n        }\r\n      }\r\n      this.seats = arr\r\n    },\r\n\r\n    handleSelect(index) {\r\n      if (this.userSelectSeats.length >= 4) {\r\n        let d = this.userSelectSeats[0] - 1\r\n        this.seats[d].status = 1\r\n        this.userSelectSeats.splice(0, 1)\r\n      }\r\n      this.userSelectSeats.push(index + 1)\r\n      this.seats[index].status = 2\r\n      this.cart.price = (this.arrangement.price) * (this.userSelectSeats.length)\r\n    },\r\n\r\n    handleDisSelect(index) {\r\n      this.seats[index].status = 1\r\n      this.userSelectSeats.splice(this.userSelectSeats.indexOf(index + 1), 1)\r\n      this.cart.price = (this.arrangement.price) * (this.userSelectSeats.length)\r\n    },\r\n\r\n    checkPhoneAndSeats() {\r\n      if (this.userSelectSeats.length === 0) {\r\n        this.$message({\r\n          message: '请选择要订购的座位',\r\n          type: 'warning'\r\n        });\r\n        return false;\r\n      }\r\n      if (this.cart.phone.length !== 11) {\r\n        this.$message({\r\n          message: '请输入11位的电话号码',\r\n          type: 'warning'\r\n        });\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n\r\n    submitSeat() {\r\n      if (this.checkPhoneAndSeats()) {\r\n        for (let i = 0; i < this.userSelectSeats.length; i++) {\r\n          this.cart.seats += this.userSelectSeats[i] + '号'\r\n        }\r\n        console.log(this.cart)\r\n        CreateCart(this.cart).then(res => {\r\n          this.$message({\r\n            message: '以为您添加购物车成功，请尽快付款吧',\r\n            type: 'success'\r\n          });\r\n          this.$router.go(-1)\r\n        })\r\n\r\n      }\r\n    },\r\n\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n@import \"../assets/css/seat.css\";\r\n\r\n.seat-main {\r\n  padding: 80px;\r\n}\r\n\r\n.seat-content {\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);\r\n  height: 850px;\r\n}\r\n\r\n.seat-aside {\r\n  width: 30%;\r\n  height: 100%;\r\n  float: left;\r\n  background: white;\r\n}\r\n\r\n.seat-aside img {\r\n  width: 140px;\r\n  height: 200px;\r\n}\r\n\r\n.seat-select {\r\n  padding-top: 50px;\r\n  padding-left: 8%;\r\n}\r\n\r\n.seat-aside-text {\r\n  padding-top: 8px;\r\n  font-size: 13px;\r\n  letter-spacing: 1px;\r\n  color: #666666;\r\n}\r\n\r\n.d1 {\r\n  font-size: 16px;\r\n  letter-spacing: 2px;\r\n  padding-bottom: 15px;\r\n}\r\n\r\n.d1 span {\r\n  color: #91949c;\r\n}\r\n\r\n.add-cart-btn {\r\n  width: 100%;\r\n  height: 60px;\r\n  border-radius: 50px;\r\n}\r\n\r\n.item {\r\n  padding-bottom: 20px;\r\n}\r\n\r\n.row-id {\r\n  padding-bottom: 11px;\r\n}\r\n\r\n>>>.el-input__inner {\r\n  border-radius: 50px;\r\n  height: 55px;\r\n}\r\n</style>"]}]}