{"remainingRequest":"E:\\project\\jy-movie\\vue-app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\project\\jy-movie\\vue-app\\src\\views\\Seat.vue?vue&type=style&index=0&id=56d61282&scoped=true&lang=css","dependencies":[{"path":"E:\\project\\jy-movie\\vue-app\\src\\views\\Seat.vue","mtime":1711526625163},{"path":"E:\\project\\jy-movie\\vue-app\\node_modules\\css-loader\\dist\\cjs.js","mtime":1711422140023},{"path":"E:\\project\\jy-movie\\vue-app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1711422144733},{"path":"E:\\project\\jy-movie\\vue-app\\node_modules\\postcss-loader\\src\\index.js","mtime":1711422141953},{"path":"E:\\project\\jy-movie\\vue-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1711422138956},{"path":"E:\\project\\jy-movie\\vue-app\\node_modules\\vue-loader\\lib\\index.js","mtime":1711422143549}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpAaW1wb3J0ICIuLi9hc3NldHMvY3NzL3NlYXQuY3NzIjsNCg0KLnNlYXQtbWFpbiB7DQogIHBhZGRpbmc6IDgwcHg7DQp9DQoNCi5zZWF0LWNvbnRlbnQgew0KICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjEyKSwgMCAwIDZweCByZ2JhKDAsIDAsIDAsIDAuMDQpOw0KICBoZWlnaHQ6IDg1MHB4Ow0KfQ0KDQouc2VhdC1hc2lkZSB7DQogIHdpZHRoOiAzMCU7DQogIGhlaWdodDogMTAwJTsNCiAgZmxvYXQ6IGxlZnQ7DQogIGJhY2tncm91bmQ6IHdoaXRlOw0KfQ0KDQouc2VhdC1hc2lkZSBpbWcgew0KICB3aWR0aDogMTQwcHg7DQogIGhlaWdodDogMjAwcHg7DQp9DQoNCi5zZWF0LXNlbGVjdCB7DQogIHBhZGRpbmctdG9wOiA1MHB4Ow0KICBwYWRkaW5nLWxlZnQ6IDglOw0KfQ0KDQouc2VhdC1hc2lkZS10ZXh0IHsNCiAgcGFkZGluZy10b3A6IDhweDsNCiAgZm9udC1zaXplOiAxM3B4Ow0KICBsZXR0ZXItc3BhY2luZzogMXB4Ow0KICBjb2xvcjogIzY2NjY2NjsNCn0NCg0KLmQxIHsNCiAgZm9udC1zaXplOiAxNnB4Ow0KICBsZXR0ZXItc3BhY2luZzogMnB4Ow0KICBwYWRkaW5nLWJvdHRvbTogMTVweDsNCn0NCg0KLmQxIHNwYW4gew0KICBjb2xvcjogIzkxOTQ5YzsNCn0NCg0KLmFkZC1jYXJ0LWJ0biB7DQogIHdpZHRoOiAxMDAlOw0KICBoZWlnaHQ6IDYwcHg7DQogIGJvcmRlci1yYWRpdXM6IDUwcHg7DQp9DQoNCi5pdGVtIHsNCiAgcGFkZGluZy1ib3R0b206IDIwcHg7DQp9DQoNCi5yb3ctaWQgew0KICBwYWRkaW5nLWJvdHRvbTogMTFweDsNCn0NCg0KPj4+LmVsLWlucHV0X19pbm5lciB7DQogIGJvcmRlci1yYWRpdXM6IDUwcHg7DQogIGhlaWdodDogNTVweDsNCn0NCg=="},{"version":3,"sources":["Seat.vue"],"names":[],"mappings":";AAgNA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Seat.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"seat-main\">\r\n    <el-steps style=\"padding-bottom: 50px\" :active=\"2\" align-center>\r\n      <el-step title=\"步骤1\" description=\"选择电影场次\"></el-step>\r\n      <el-step title=\"步骤2\" description=\"选择座位号\"></el-step>\r\n      <el-step title=\"步骤3\" description=\"加入购物车\"></el-step>\r\n      <el-step title=\"步骤4\" description=\"结算付款\"></el-step>\r\n    </el-steps>\r\n    <div class=\"seat-content\">\r\n      <div class=\"seat-aside\">\r\n        <div style=\"display: flex\">\r\n          <img style=\"padding: 30px\" :src=\"film.cover\" alt=\"\" />\r\n          <div>\r\n            <div style=\"\r\n                padding-top: 40px;\r\n                padding-bottom: 10px;\r\n                font-size: 25px;\r\n                letter-spacing: 2px;\r\n              \">\r\n              {{ film.name }}\r\n            </div>\r\n            <div class=\"seat-aside-text\">类型：{{ film.type }}</div>\r\n            <div class=\"seat-aside-text\">地区：{{ film.region }}</div>\r\n            <div class=\"seat-aside-text\">时长：{{ film.duration }}分钟</div>\r\n          </div>\r\n        </div>\r\n        <div style=\"padding: 5px 30px\">\r\n          <div class=\"d1\"><span>放映：</span>{{ arrangement.type }}</div>\r\n          <div class=\"d1\" style=\"color: #f56c6c\">\r\n            <span>开场：</span>{{ arrangement.date }}\r\n            {{ arrangement.startTime }}\r\n          </div>\r\n          <div class=\"d1\"><span>散场：</span>{{ arrangement.endTime }}</div>\r\n          <div class=\"d1\"><span>票价：</span>¥{{ arrangement.price }}/张</div>\r\n          <el-divider></el-divider>\r\n          <div class=\"d1\">\r\n            已选座位：\r\n            <el-tag v-for=\"(item, i) in userSelectSeats\" :key=\"i\" type=\"danger\" style=\"margin-right: 5px\"\r\n              effect=\"light\">\r\n              {{ item }} 号\r\n            </el-tag>\r\n          </div>\r\n          <div class=\"d1\" style=\"padding-top: 10px\">\r\n            总计：\r\n            <span style=\"color: #f56c6c\">¥ </span>\r\n            <span style=\"color: #f56c6c; font-size: 25px; font-weight: bold\">{{ cart.price }}</span>\r\n          </div>\r\n          <el-divider></el-divider>\r\n          <div style=\"padding: 0 50px\">\r\n            <el-input v-model=\"cart.phone\" style=\"padding-top: 20px; padding-bottom: 30px\" placeholder=\"请输入手机号码\"\r\n              clearable>\r\n            </el-input>\r\n            <el-button @click=\"submitSeat\" class=\"add-cart-btn\" type=\"danger\" round>加入购物车\r\n            </el-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"hall seat-select\">\r\n        <div class=\"seat-example\">\r\n          <div class=\"selectable-example example\">\r\n            <span>可选座位</span>\r\n          </div>\r\n          <!-- <div class=\"couple-example example\">\r\n            <span>情侣卡座</span>\r\n          </div> -->\r\n          <div class=\"sold-example example\">\r\n            <span>已售座位</span>\r\n          </div>\r\n          <div class=\"selected-example example\">\r\n            <span>已选座位</span>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <div class=\"seats-block\">\r\n          <div class=\"seats-container\">\r\n            <div class=\"screen-container\" style=\"left: 5px\">\r\n              <div class=\"screen\">银幕中央</div>\r\n              <div class=\"c-screen-line\"></div>\r\n            </div>\r\n\r\n            <div class=\"seats-wrapper\">\r\n              <div style=\"padding: 0 40px;width: 500px\">\r\n                <span v-for=\"(item, index) in seats\" :key=\"index\">\r\n                  <!--不可选-->\r\n                  <span v-if=\"item.status === 0\" class=\"seat sold item\" />\r\n                  <!--可选-->\r\n                  <span v-if=\"item.status === 1\" @click=\"handleSelect(index)\" class=\"seat selectable item\" />\r\n                  <!--已选-->\r\n                  <span v-if=\"item.status === 2\" @click=\"handleDisSelect(index)\" class=\"seat selected item\" />\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { FindArrangementById, GetArrangementSeats } from \"@/api/film\";\r\nimport { CreateCart } from \"@/api/cart\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      cart: {\r\n        uid: localStorage.getItem(\"uid\"),\r\n        aid: this.$route.query.id,\r\n        seats: '',\r\n        phone: \"18903803658\",\r\n        price: 0\r\n      },\r\n      arrangement: {},\r\n      film: {},\r\n      seats: [],\r\n      userSelectSeats: [],\r\n      selectSeats: [],\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    FindArrangementById(this.$route.query.id).then((res) => {\r\n      this.arrangement = res.data.arrangement;\r\n      this.film = res.data.film;\r\n      GetArrangementSeats(this.$route.query.id).then(res => {\r\n        this.selectSeats = res.data;\r\n        this.loadSeats();\r\n      })\r\n    });\r\n  },\r\n\r\n  methods: {\r\n    //0 已选\r\n    //1 可选\r\n    //2 已选中\r\n    loadSeats() {\r\n      const n = this.arrangement.seatNumber\r\n      let arr = new Array(n)\r\n      for (let i = 0; i < n; i++) {\r\n        if (this.selectSeats.indexOf(i + 1) === -1) {\r\n          arr[i] = { seat: i + 1, status: 1 }\r\n        } else {\r\n          arr[i] = { seat: i + 1, status: 0 }\r\n        }\r\n      }\r\n      this.seats = arr\r\n    },\r\n\r\n    handleSelect(index) {\r\n      if (this.userSelectSeats.length >= 4) {\r\n        let d = this.userSelectSeats[0] - 1\r\n        this.seats[d].status = 1\r\n        this.userSelectSeats.splice(0, 1)\r\n      }\r\n      this.userSelectSeats.push(index + 1)\r\n      this.seats[index].status = 2\r\n      this.cart.price = (this.arrangement.price) * (this.userSelectSeats.length)\r\n    },\r\n\r\n    handleDisSelect(index) {\r\n      this.seats[index].status = 1\r\n      this.userSelectSeats.splice(this.userSelectSeats.indexOf(index + 1), 1)\r\n      this.cart.price = (this.arrangement.price) * (this.userSelectSeats.length)\r\n    },\r\n\r\n    checkPhoneAndSeats() {\r\n      if (this.userSelectSeats.length === 0) {\r\n        this.$message({\r\n          message: '请选择要订购的座位',\r\n          type: 'warning'\r\n        });\r\n        return false;\r\n      }\r\n      if (this.cart.phone.length !== 11) {\r\n        this.$message({\r\n          message: '请输入11位的电话号码',\r\n          type: 'warning'\r\n        });\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n\r\n    submitSeat() {\r\n      if (this.checkPhoneAndSeats()) {\r\n        for (let i = 0; i < this.userSelectSeats.length; i++) {\r\n          this.cart.seats += this.userSelectSeats[i] + '号'\r\n        }\r\n        console.log(this.cart)\r\n        CreateCart(this.cart).then(res => {\r\n          this.$message({\r\n            message: '以为您添加购物车成功，请尽快付款吧',\r\n            type: 'success'\r\n          });\r\n          this.$router.go(-1)\r\n        })\r\n\r\n      }\r\n    },\r\n\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n@import \"../assets/css/seat.css\";\r\n\r\n.seat-main {\r\n  padding: 80px;\r\n}\r\n\r\n.seat-content {\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);\r\n  height: 850px;\r\n}\r\n\r\n.seat-aside {\r\n  width: 30%;\r\n  height: 100%;\r\n  float: left;\r\n  background: white;\r\n}\r\n\r\n.seat-aside img {\r\n  width: 140px;\r\n  height: 200px;\r\n}\r\n\r\n.seat-select {\r\n  padding-top: 50px;\r\n  padding-left: 8%;\r\n}\r\n\r\n.seat-aside-text {\r\n  padding-top: 8px;\r\n  font-size: 13px;\r\n  letter-spacing: 1px;\r\n  color: #666666;\r\n}\r\n\r\n.d1 {\r\n  font-size: 16px;\r\n  letter-spacing: 2px;\r\n  padding-bottom: 15px;\r\n}\r\n\r\n.d1 span {\r\n  color: #91949c;\r\n}\r\n\r\n.add-cart-btn {\r\n  width: 100%;\r\n  height: 60px;\r\n  border-radius: 50px;\r\n}\r\n\r\n.item {\r\n  padding-bottom: 20px;\r\n}\r\n\r\n.row-id {\r\n  padding-bottom: 11px;\r\n}\r\n\r\n>>>.el-input__inner {\r\n  border-radius: 50px;\r\n  height: 55px;\r\n}\r\n</style>"]}]}